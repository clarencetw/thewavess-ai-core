# NSFW 指南（極簡布林分流）

本指南說明目前採用的 NSFW 策略：預設 OpenAI；僅遇明確露骨（器官/性行為）才路由 Grok，並加入短期遲滯避免抖動。

## 目標
- 預設使用 OpenAI，對話自然、體驗一致。
- 明確 NSFW（性器官/性行為等）一律由 Grok 處理。
- 少即是多：簡單、高效、低維護成本。

## 策略總覽
- 分類器：關鍵字布林門（命中→Level 5；否則→Level 1）。
- 引擎路由：
  - 角色標籤含 `nsfw`/`adult` → 直接 Grok。
  - 會話遲滯：某會話一旦命中 NSFW，接下來 3 分鐘該會話直接 Grok。
  - 其他情況：布林 `IsNSFW` 為 true → Grok；false → OpenAI。
- Prompt 等級：OpenAI 固定 L1；Grok 固定 L5（避免中間級造成混亂）。

## 關鍵字（示例）
- 明確行為：做愛、性愛、性行為、性交、高潮、射精、自慰、口交、肛交
- 器官詞：性器官、陰莖、陰道、乳頭、胸部、裸體
- 情境詞：色情、床戲、成人片、打炮
- 英文：sex、porn、nude、nsfw

## 合規安全
- 禁止：未成年、非自願/強迫、暴力性行為、血腥、仇恨等（直接拒絕）。
- 年齡同意：涉及成人內容時，需年齡確認與同意。

## 好感度整合
- 好感度照常讀取/注入/更新（0–100），不參與 NSFW 路由決策。
- AI 可依 `EmotionDelta` 提供微幅調整；保存於資料庫。

## 測試與觀測
- 測試腳本已調整為布林分流：非露骨期望 L1；露骨期望 L5。
- 觀測日誌：紀錄 `is_nsfw`、路由引擎、理由碼（不存原文）。

## 可選強化（保持簡單）
- 灰名單：可另加一組「成人暗示」關鍵字（預設關閉），命中亦路由 Grok。
- 遲滯可配置：以環境變數調整秒數或關閉。
