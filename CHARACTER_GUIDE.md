# 角色系統指南

## 系統概述

本系統採用**簡潔實用的角色管理**，專注於核心功能和AI驅動的個性化體驗。

### 🎯 設計原則
- **簡單高效**：單表設計，避免過度複雜的關聯
- **AI驅動**：依靠AI理解角色描述，動態生成個性化對話
- **用戶自訂**：支援用戶自由描述角色外觀、性格、背景
- **靈活標籤**：簡單的標籤系統支援分類和搜尋

## 資料庫結構

### 📋 Characters 表（單一核心表）
```sql
characters:
├── id (string, PK)              # 角色唯一標識
├── name (string)                # 角色名稱
├── type (string)                # 角色類型
├── locale (string)              # 預設語系 (zh-TW)
├── is_active (boolean)          # 是否啟用
├── avatar_url (string, 可選)    # 頭像URL
├── popularity (int)             # 人氣值
├── tags (string[])              # 標籤陣列
├── user_description (string)    # 用戶自訂角色描述
├── created_at (timestamp)       # 創建時間
└── updated_at (timestamp)       # 更新時間
```

## 角色類型系統

### 🎭 內建角色類型
- **dominant** - 強勢主導型：自信、掌控慾強
- **gentle** - 溫柔體貼型：細心、溫暖、包容
- **playful** - 活潑俏皮型：幽默、輕鬆、有趣
- **mystery** - 神秘冷漠型：深沉、內斂、高冷
- **reliable** - 可靠穩重型：成熟、負責、值得信賴

### 🎨 AI個性化機制
AI會根據角色類型和用戶描述：
1. **語氣適配**：自動調整對話語氣和用詞風格
2. **性格表現**：體現角色的核心性格特徵
3. **情感反應**：根據角色類型產生不同的情感回應
4. **行為模式**：展現符合角色設定的行為模式

## API端點功能

### 🔓 公開端點（無需認證）
- `GET /api/v1/character/list` - 角色列表（支援篩選、分頁、搜尋）
- `GET /api/v1/character/search` - 角色搜尋
- `GET /api/v1/character/{id}` - 角色詳情
- `GET /api/v1/character/{id}/stats` - 角色統計資訊

### 🔐 管理員端點（需要管理員權限）
- `POST /api/v1/character` - 創建角色
- `PUT /api/v1/character/{id}` - 更新角色
- `DELETE /api/v1/character/{id}` - 刪除角色

### 🔑 用戶端點（需要用戶認證）
- `GET /api/v1/character/{id}/profile` - 獲取角色檔案配置

## 查詢與篩選功能

### 🔍 支援的查詢參數
- **分頁控制**：`page`, `page_size`
- **類型篩選**：`type` (dominant/gentle/playful/mystery/reliable)
- **狀態篩選**：`is_active`
- **標籤篩選**：`tags` (字符串陣列)
- **文本搜尋**：`search` (搜尋名稱或描述)
- **排序控制**：`sort_by`, `sort_order`

### 📊 統計功能
- 角色人氣度追蹤
- 互動次數統計
- 用戶數量統計
- 平均好感度（當有關係資料時）

## 角色創建流程

### 🛠️ 管理員創建
1. **基本資訊**：設定名稱、類型、語系
2. **標籤設定**：添加分類標籤
3. **描述內容**：編寫角色背景描述
4. **狀態控制**：設定啟用狀態和人氣度

### 👤 用戶自訂描述
用戶可以通過 `user_description` 欄位自由描述：
- **外觀特徵**：身高、髮色、穿衣風格等
- **性格特質**：溫柔、幽默、神秘、可靠等
- **背景故事**：職業、經歷、興趣愛好等
- **互動偏好**：說話習慣、行為模式等

## AI整合機制

### 🤖 智能理解
AI會自動解析角色資訊：
- **類型識別**：理解角色的基本類型定位
- **描述解析**：深度理解用戶自訂的角色描述
- **個性建模**：建立角色的個性化行為模型
- **情境適配**：根據對話情境調整表現方式

### 💭 對話生成
- **風格一致**：保持角色的語言風格和個性特徵
- **情感智能**：根據關係狀態調整情感表達
- **語境感知**：理解對話背景和用戶意圖
- **個性化回應**：生成符合角色設定的個性化內容

## 系統特色

### ✨ 核心優勢
1. **簡潔架構**：單表設計，高效查詢
2. **AI驅動**：智能理解和個性化生成
3. **用戶友好**：直觀的類型系統和自由描述
4. **高性能**：優化的資料庫索引和查詢

### 🚀 擴展性
- **標籤系統**：靈活的分類和組織方式
- **多語系支援**：內建國際化支援框架
- **統計分析**：完整的使用數據追蹤
- **權限控制**：清晰的權限分層管理

## 最佳實踐

### 📝 角色描述建議
- **具體明確**：提供具體的外觀和性格描述
- **保持一致**：確保描述與選定類型匹配
- **豐富細節**：適度添加背景故事和個性特徵
- **避免矛盾**：確保各項描述之間的邏輯一致

### 🎯 系統使用
- **合理分類**：使用適當的類型和標籤分類
- **定期維護**：定期檢查和更新角色資訊
- **性能監控**：關注系統性能和用戶體驗
- **數據分析**：利用統計數據優化角色設計

---

*本系統專注於核心功能，通過AI智能理解實現豐富的角色個性化體驗。*